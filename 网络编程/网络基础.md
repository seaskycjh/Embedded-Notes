## 网络基础

[TOC]

------

### 1 OSI模型

一个网络体系结构模型，称为开放系统互联参考模型（OSI），OSI有7层，从低到高依次称为物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。

**物理层：**在链路上透明地传输位。需要完成的工作包括线路配置、确定数据传输模式、确定信号形式、对信号进行编码、连接传输介质。

**数据链路层：**把不可靠的信道变为可靠的信道。为此将比特组成帧，在链路上提供点到点的帧传输，并进行差错控制、流量控制等。(交换机)

**网络层：**在源节点-目的节点之间进行路由选择、拥塞控制、顺序控制、传送包，保证报文的正确性。网络层控制着通信子网的运行，因而它又称为通信子网层。(路由器，IP)

**传输层：**提供端-端间可靠的、透明的数据传输，保证报文顺序的正确性、数据的完整性。(TCP)

**会话层：**建立通信进程的逻辑名字与物理名字之间的联系，提供进程之间建立、管理和终止会话的方法，处理同步与恢复问题。

**表示层：**实现数据转换（包括格式转换、压缩、加密等），提供标准的应用接口、公用的通信服务、公共数据表示方法。

**应用层：**对用户不透明的各种服务，

### 1 物理层

物理层下面的传输媒体可分为两大类：导引型传输媒体（有线传输铜线或者光纤）和非导引型传输媒体（自由空间，无线传输）。

### 2 数据链路层

**链路**：从一个结点到相邻结点的一段物理路线（有线或无线），而中间没有任何其他的交换点。

**数据链路**：当在一条线路上传输数据时，除了必须有一条物理路外，还必须有一些必要的通信协议来控制这些数据的传输。把实现这些协议的硬件和软件加到链路上就构成了数据链路。

**帧**：点信道的数据链路层的协议数据单元。 

数据链路层三个基本问题：

**封装成帧**：在一段数据的前后分别添加首部和尾部，这样就构成了一个帧。

**透明传输**：当传送的帧是文本文件组成的帧时，不管从键盘上输入什么字符都能传输过去，这样的传输就是透明传输。

**差错检测**：比特传输过程中可能会出现差错，1可能会变成0,0可能会变成1.这就叫做比特差错。

#### 2.1 点对点信道

#### 2.2 广播信道

### 3 网络层

#### 3.1 网际协议IP

与IP协议配套使用的三个协议：

地址解析协议ARP

网际控制报文协议ICMP

网际组管理协议IGMP

网络连接的中间设备：

**中间设备转发器（repeater）**：物理层使用。

**中间设备网桥或桥接器**（bridge）：数据链路层使用。

**中间设备路由器**（router） ：网络层使用。
**网关**（gateway）：在网络层以上使用的中间设备。

#### 3.2 IP地址

IP地址就是给因特网上的每一个主机（或路由器）的每一个接口分配一个在全世界范围唯一的32位标识符。

IP地址的特点：

- 每一个IP地址都是由网络号和主机号组成，**网络号**（net-id）,它标志主机（或路由器）所连接到的网络，**主机号**（host-id），它标志该主机（或路由器）。
- IP地址是标志一个主机和一条链路的接口。当一个主机同时连接到两个网络上时，该主机就必须同时具有两个相应的IP地址，其网络号必须是不同的。
- 用转发器或网桥连接起来的若干个局域网仍为一个网络。
- 在IP地址中，所有分配到的网络号的网络都是平等的。

IP地址是网络层和以上各层使用的地址，是一种逻辑地址。IP地址放在IP数据报的首部，硬件地址放在MAC帧的首部。

#### 3.3 划分子网和构造超网

**划分子网**：

**子网掩码**：从IP数据报的首部无法看出源主机或目的主机所连接的网络是否进行子网的划分。使用子网掩码的好处：不管网络有没有子网，只要把子网掩码和IP地址进行逐位的“与”运算（AND），就能立即得出网络地址来。

- A类地址的默认子网掩码是255.0.0.0，或0xFF000000。
- B类地址的默认子网掩码是255.255.0.0，或0xFFFF0000。
- C类地址的默认子网掩码是255.255.255.0，或0xFFFFFF00。 

#### 3.5 VPN和NAT

**虚拟专用网（VPN）**：在因特网中的所有路由器，对目的地址是专用地址的数据报一律不进行转发 
利用公用的因特网作为机构专用网之间的通信载体。

**网络地址转换（NAT）**：



### 4 运输层

#### 4.1 进程间通信

运输层向它上面的应用层提供通信服务，两个主机进行通信就是两个主机中的应用进程相互通信。通信的真正端点并不是主机而是主机中的进程。端到端的通信是应用进程之间的通信。运输层有一个重要功能：

**复用（multiplexing）**：指在发送方不同的应用进程都可以使用同一个运输层协议传送数据。

**分用（demultiplexing）**：指接收方的运输层在剥去报文的首部后能够把这些数据正确交付目的应用进程。 

网络层是为主机之间提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信。

根据应用程序的不同需求，运输层需要有两种不同的运输协议，即面向连接的TCP和无连接的UDP。运输层向高层用户屏蔽了下面网络核心的细节（如网络拓扑、所采用的路由选择协议等），它使应用进程看见的就是好像在两个运输层实体之间有一条端到端的逻辑通信信道。

#### 4.2 TCP和UDP协议

| 应用           | 应用层协议  | 传输层协议 | 端口号 |
| -------------- | ----------- | ---------- | ------ |
| 域名转换       | DNS         | UDP        | 53     |
| 文件传送       | TFTP        | UDP        | 69     |
| 路由选择协议   | RIP         | UDP        |        |
| IP地址配置     | BOOTP，DHCP | UDP        |        |
| 网络管理       | SNMP        | UDP        | 161    |
| 远程文件服务   | NFS         | UDP        |        |
| IP电话         | 专用协议    | UDP        |        |
| 流式多媒体通信 | 专用协议    | UDP        |        |
| 多播           | IGMP        | UDP        |        |
| 电子邮件       | SMTP        | TCP        | 25     |
| 远程终端接入   | Talnet      | TCP        | 23     |
| 万维网         | HTTP        | TCP        | 80     |
| 文件传送       | FTP         | TCP        | 21     |

#### 4.3 运输层的端口

在协议栈层间的抽象的协议端口是软件端口，软件端口是应用层的各种协议进程与运输实体进行层间交互的一种地址。 TCP/IP使用源端口和目的端口两个重要字段，用一个16位端口号来标志一个端口。 

### 5 应用层

#### 5.1 域名系统DNS

域名系统DNS（domain name system）是因特网使用的命名系统，用来把便于人们使用的机器的名字转换为IP地址。

**域名（domain name）**：任何一个连接在因特网上的主机或者路由器，都是有一个唯一的层次结构的名字。DNS规定，域名中的标号都是有英文字母和数字组成，每一个标号不超过63个字符。

级别最低的域名写在最左边，而级别最高的顶级域名则写在最右边。顶级域名分为三大类：

- 国家顶级域名nTLD。如cn,us,uk…. 
- 通用顶级域名gTLD。如com,net,org…… 
- 基础结构域名（infrastructure domain）：这种域名只有一个，即arpa，用于反向域名解析。

#### 5.2 文件传送协议

**文件传送协议FTP**（file transfer protocol）是英特网上使用得最广泛的文件传送协议。

**网络文件系统NFS**允许应用进程打开一个远地文件，并能在该文件的某一个特定的位置上开始读写数据。

**简单文件传送协议TFTP**（trivial file transfer protocol）。

#### 5.3 远程终端协议

TELNET又称为终端仿真协议。

#### 5.4 万维网WWW

万维网是一个大规模、联机式的信息储藏所。万维网是一个分布式的超媒体（hypermedia）系统，它是超文本系统的扩充。万维网以客户-服务器方式工作。客户程序向服务器程序发送请求，服务器程序向客户程序发回客户所要的万维网文档。

#### 5.5 邮件

一个电子邮件系统有三个主要组成构件：用户代理、邮件服务器，以及邮件协议（包括邮件发送协议）。

### 6 网络安全

#### 6.1 安全协议

**运输层安全协议**：安全套接字层SSL（secure socket layer）、运输层安全TLS。